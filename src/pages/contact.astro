---
import Layout from '../layouts/Layout.astro';
import Navigation from '../components/Navigation.astro';
import Footer from '../components/Footer.astro';
---

<Layout title="Contact â€” Civiq Design" description="Get in touch with Brian Hendrick to discuss your government service design project. Senior expertise, direct access.">
  <Navigation />

  <a href="#main-content" class="skip-link">Skip to main content</a>

  <main id="main-content" class="pt-16">
    <!-- Contact Page Hero -->
    <section class="section-padding animate-fade-in-up" style="background-color: var(--color-rice-white);">
      <div class="mx-auto px-6 sm:px-8 lg:px-12" style="max-width: 680px;">
        <div class="mb-12">
          <h1 class="text-h1 mb-6 headline-balance" style="color: var(--color-forest-green);">
            Let's talk about your project.
          </h1>
          <div class="space-y-4">
            <p class="text-intro" style="color: var(--color-forest-green); opacity: 0.75;">
              Need embedded support, strategic advice, or a thought partner? I'd love to hear what you're working on.
            </p>
            <p class="text-body" style="color: var(--color-forest-green); opacity: 0.7;">
              Fill out the form below and I'll get back to you within 1-2 business days.
            </p>
          </div>
        </div>

        <!-- Contact Form -->
        <form
          id="contact-form"
          action="https://formspree.io/f/xkgdqkbg"
          method="POST"
          class="space-y-6"
        >
          <!-- Honeypot field for spam prevention -->
          <input type="text" name="_gotcha" style="display:none" tabindex="-1" autocomplete="off">

          <!-- Hidden subject line -->
          <input type="hidden" name="_subject" value="New inquiry from Civiq website">

          <!-- Name -->
          <div>
            <label for="name" class="block text-sm font-medium mb-2" style="color: var(--color-forest-green);">
              Your name <span style="color: var(--color-warm-clay);">*</span>
            </label>
            <input
              type="text"
              id="name"
              name="name"
              required
              placeholder="Your name"
              class="w-full px-4 py-3 rounded border transition-all duration-200"
              style="border-color: var(--color-grey-d); background-color: var(--color-white); color: var(--color-forest-green);"
            />
          </div>

          <!-- Email -->
          <div>
            <label for="email" class="block text-sm font-medium mb-2" style="color: var(--color-forest-green);">
              Email address <span style="color: var(--color-warm-clay);">*</span>
            </label>
            <input
              type="email"
              id="email"
              name="email"
              required
              placeholder="you@organization.com"
              class="w-full px-4 py-3 rounded border transition-all duration-200"
              style="border-color: var(--color-grey-d); background-color: var(--color-white); color: var(--color-forest-green);"
            />
          </div>

          <!-- Organization -->
          <div>
            <label for="organization" class="block text-sm font-medium mb-2" style="color: var(--color-forest-green);">
              Organization <span style="color: var(--color-warm-clay);">*</span>
            </label>
            <input
              type="text"
              id="organization"
              name="organization"
              required
              placeholder="Your organization"
              class="w-full px-4 py-3 rounded border transition-all duration-200"
              style="border-color: var(--color-grey-d); background-color: var(--color-white); color: var(--color-forest-green);"
            />
          </div>

          <!-- What are you looking for? -->
          <div>
            <label for="service_type" class="block text-sm font-medium mb-2" style="color: var(--color-forest-green);">
              What are you looking for?
            </label>
            <select
              id="service_type"
              name="service_type"
              class="w-full px-4 py-3 rounded border transition-all duration-200"
              style="border-color: var(--color-grey-d); background-color: var(--color-white); color: var(--color-forest-green);"
            >
              <option value="">Select an option...</option>
              <option value="embedded-delivery">Embedded delivery support</option>
              <option value="strategic-advisory">Strategic advisory</option>
              <option value="service-design">Service design / user research</option>
              <option value="capability-building">Capability building / coaching</option>
              <option value="partnership">Partnership opportunity</option>
              <option value="other">Something else</option>
            </select>
          </div>

          <!-- Tell me about your project -->
          <div>
            <label for="message" class="block text-sm font-medium mb-2" style="color: var(--color-forest-green);">
              Tell me about your project <span style="color: var(--color-warm-clay);">*</span>
            </label>
            <textarea
              id="message"
              name="message"
              required
              rows="6"
              placeholder="What challenge are you trying to solve? What does success look like?"
              class="w-full px-4 py-3 rounded border transition-all duration-200 resize-y"
              style="border-color: var(--color-grey-d); background-color: var(--color-white); color: var(--color-forest-green); min-height: 150px;"
            ></textarea>
          </div>

          <!-- How did you find me? -->
          <div>
            <label for="referral_source" class="block text-sm font-medium mb-2" style="color: var(--color-forest-green);">
              How did you find me?
            </label>
            <select
              id="referral_source"
              name="referral_source"
              class="w-full px-4 py-3 rounded border transition-all duration-200"
              style="border-color: var(--color-grey-d); background-color: var(--color-white); color: var(--color-forest-green);"
            >
              <option value="">Select an option...</option>
              <option value="referral">Referral</option>
              <option value="linkedin">LinkedIn</option>
              <option value="web-search">Web search</option>
              <option value="conference">Conference or event</option>
              <option value="previous-collaboration">Previous collaboration</option>
              <option value="other">Other</option>
            </select>
          </div>

          <!-- Submit Button -->
          <div class="pt-4">
            <button
              type="submit"
              id="submit-button"
              class="w-full sm:w-auto inline-flex items-center justify-center px-8 py-4 text-base rounded transition-all duration-200"
              style="background-color: var(--color-warm-clay); color: var(--color-white); font-weight: var(--font-weight-medium); border: none; cursor: pointer;"
            >
              <span id="button-text">Send Message</span>
              <span id="button-loader" class="hidden ml-2">
                <svg class="animate-spin h-5 w-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                  <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                  <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
              </span>
            </button>
          </div>

          <!-- Success Message -->
          <div id="success-message" class="hidden p-4 rounded" role="alert" aria-live="polite" style="background-color: rgba(217, 237, 181, 0.2); border-left: 4px solid var(--color-pear-green);">
            <p style="color: var(--color-forest-green); font-weight: var(--font-weight-medium);">
              Thanks for reaching out. I'll be in touch within 1-2 business days.
            </p>
          </div>

          <!-- Error Message -->
          <div id="error-message" class="hidden p-4 rounded" role="alert" aria-live="assertive" style="background-color: rgba(220, 38, 38, 0.1); border-left: 4px solid #dc2626;">
            <p style="color: #dc2626; font-weight: var(--font-weight-medium);">
              Something went wrong. Please try again or email me directly.
            </p>
          </div>
        </form>

        <!-- Alternative Contact -->
        <div class="mt-16 pt-8 border-t" style="border-color: var(--color-grey-d);">
          <p class="text-body flex flex-wrap items-center gap-2" style="color: var(--color-forest-green); opacity: 0.7;">
            <span>Prefer email?</span>
            <a href="mailto:info@civiq.design" class="inline-flex items-center justify-center px-4 py-2 text-sm rounded border transition-all duration-200" style="color: var(--color-forest-green); border-color: rgba(18, 64, 69, 0.25); background-color: transparent;">
              Email me directly
            </a>
          </p>
          <p class="text-body mt-3" style="color: var(--color-forest-green); opacity: 0.7;">
            You can also find me on <a href="https://www.linkedin.com/in/hendrickbrian/" target="_blank" rel="noopener noreferrer" class="contact-link transition-colors duration-200" style="color: var(--color-warm-clay); font-weight: var(--font-weight-medium);">LinkedIn</a>.
          </p>
        </div>
      </div>
    </section>
  </main>

  <Footer />

  <style>
    /* Form input focus states */
    input:focus,
    textarea:focus,
    select:focus {
      outline: none;
      border-color: var(--color-warm-clay) !important;
      box-shadow: 0 0 0 3px rgba(214, 118, 86, 0.1);
    }

    /* Button hover state */
    button[type="submit"]:hover {
      background-color: #C4624A !important;
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(214, 118, 86, 0.2);
    }

    button[type="submit"]:active {
      transform: translateY(0);
    }

    button[type="submit"]:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }

    /* Spinner animation */
    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    .animate-spin {
      animation: spin 1s linear infinite;
    }

    /* Select arrow */
    select {
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3E%3Cpath stroke='%23124045' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3E%3C/svg%3E");
      background-position: right 0.75rem center;
      background-repeat: no-repeat;
      background-size: 1.5em 1.5em;
      padding-right: 2.5rem;
      appearance: none;
    }

    /* Contact link hover */
    .contact-link:hover {
      color: #C4624A !important;
    }
  </style>

  <script>
    const form = document.getElementById('contact-form') as HTMLFormElement;
    const submitButton = document.getElementById('submit-button') as HTMLButtonElement;
    const buttonText = document.getElementById('button-text') as HTMLSpanElement;
    const buttonLoader = document.getElementById('button-loader') as HTMLSpanElement;
    const successMessage = document.getElementById('success-message') as HTMLDivElement;
    const errorMessage = document.getElementById('error-message') as HTMLDivElement;

    form.addEventListener('submit', async (e) => {
      e.preventDefault();

      // Hide previous messages
      successMessage.classList.add('hidden');
      errorMessage.classList.add('hidden');

      // Show loading state
      submitButton.disabled = true;
      buttonText.textContent = 'Sending...';
      buttonLoader.classList.remove('hidden');

      try {
        const formData = new FormData(form);
        const response = await fetch(form.action, {
          method: 'POST',
          body: formData,
          headers: {
            'Accept': 'application/json'
          }
        });

        if (response.ok) {
          // Show success message
          successMessage.classList.remove('hidden');
          form.reset();

          // Scroll to success message
          successMessage.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        } else {
          // Show error message
          errorMessage.classList.remove('hidden');
        }
      } catch (error) {
        // Show error message
        errorMessage.classList.remove('hidden');
      } finally {
        // Reset button state
        submitButton.disabled = false;
        buttonText.textContent = 'Send Message';
        buttonLoader.classList.add('hidden');
      }
    });
  </script>
</Layout>
