---
/**
 * CaseStudyHero - Clean hero with subtle parallax logo watermark
 *
 * Uses generative colors for unique accent while maintaining accessibility.
 */

import { generateContourPattern } from '../../utils/contourGenerator';

interface Props {
  client: string;
  title: string;
  slug: string;
  summary: string;
  services: string[];
  impact: string;
}

const { client, title, slug, summary, services, impact } = Astro.props;

// Get unique colors for this case study
const pattern = generateContourPattern(slug, { width: 100, height: 100, levels: 1, complexity: 1 });
const { colorScheme } = pattern;
---

<header class="case-study-hero">
  <!-- Subtle parallax logo watermark -->
  <div class="watermark-container" aria-hidden="true">
    <svg
      class="watermark-logo"
      viewBox="0 0 2200 2800"
      fill="none"
      style={`color: ${colorScheme.primary};`}
    >
      <path d="M2057.1685,1361.2754c0-71.8848-13.0315-140.7808-36.84-204.4629l178.7949-103.2271c178.5981,216.4224,493.2818,278.9834,744.1883,134.1226.0006-.0005.0013-.001.0017-.001l-96.5959-167.3091s-.0011.0005-.0017.001c-158.2767,91.3809-354.4312,59.5747-476.7137-65.4707l150.6749-86.9922-97.2673-168.4717-150.6735,86.9912c-47.1473-168.4204,23.3851-354.1948,181.6598-445.5747.0006-.0005.0013-.001.0017-.001l-96.5959-167.3091s-.0011.0005-.0017.001c-250.9045,144.8599-354.0671,448.6606-255.9429,711.541l-179.0365,103.3667c-107.4824-129.8477-269.8264-212.7114-451.1638-212.7114s-343.7194,82.8828-451.2014,212.7563l-179.019-103.3564c98.1589-262.8931-5.0007-566.7261-255.9226-711.5962-.0007-.0005-.0015-.0005-.002-.001l-96.5957,167.3091s.001.0005.0017.001c158.2925,91.3901,228.8228,277.1963,181.6433,445.6323l-150.7727-87.0488-97.2673,168.4717,150.749,87.0352c-122.2854,125.0098-318.4136,156.7983-476.6724,65.4277-.0005-.0005-.0012-.001-.0015-.001L0,1187.707s.0012.0005.002.001c250.8889,144.8506,565.5459,82.3081,744.1506-134.0776l178.8118,103.2368c-23.7954,63.6665-36.8193,132.5439-36.8193,204.4082,0,289.7056,211.4919,530.9355,488.1899,577.4189v206.4438c-276.698,46.4834-488.1899,287.7129-488.1899,577.415v.002h193.1918v-.002c0-182.7422,125.5939-336.6992,294.9982-380.0967v174.0703h194.5347v-174.0977c169.4592,43.3594,295.1069,197.3428,295.1069,380.124v.002h193.1919v-.002c0-289.7402-211.5474-530.9956-488.2988-577.4336v-206.4067c276.7515-46.438,488.2988-287.6938,488.2988-577.4375ZM1079.3368,1361.2754c0-216.3228,175.9929-392.3154,392.3199-392.3154,143.6079,0,269.4404,77.5591,337.8113,192.9883l4.1409,7.1724c32.0585,56.8242,50.3677,122.3906,50.3677,192.1548,0,216.3271-175.9929,392.3198-392.3198,392.3198s-392.3199-175.9927-392.3199-392.3198Z" fill="currentColor" opacity="0.1"/>
      <path d="M1471.6567,585.5098C1794.5109,585.5098,2057.1685,322.8521,2057.1685.002v-.002h-193.1918v.002c0,216.3232-175.9929,392.3159-392.3199,392.3159S1079.3369,216.3252,1079.3369.002v-.002h-193.1919v.002c0,322.8501,262.6577,585.5078,585.5117,585.5078Z" fill="currentColor" opacity="0.1"/>
      <path d="M2143.4912,1749.1616c-161.427,279.5996-65.2876,638.3965,214.3088,799.8213.0006.001.0013.001.0017.001l96.5959-167.3086s-.0011-.001-.0017-.001c-187.3412-108.1611-251.7591-348.5723-143.5956-535.917,108.1635-187.3447,348.5742-251.7627,535.9155-143.6011.0006.0005.0013.001.0017.001l96.5959-167.3091s-.0011-.0005-.0017-.001c-279.5964-161.4248-638.3935-65.2856-799.8205,214.3145Z" fill="currentColor" opacity="0.1"/>
      <path d="M.002,1534.8472c-.0007.0005-.0015.001-.002.001l96.5962,167.3091s.001-.0005.0015-.001c187.3413-108.1616,427.7522-43.7437,535.9155,143.6011,108.1636,187.3447,43.7456,427.7559-143.5955,535.917-.0007,0-.0012.001-.0017.001l96.5957,167.3086s.0012,0,.002-.001c279.5962-161.4248,375.7358-520.2217,214.3086-799.8213C638.3953,1469.5615,279.5981,1373.4224.002,1534.8472Z" fill="currentColor" opacity="0.1"/>
    </svg>
  </div>

  <div class="hero-inner">
    <a href="/case-studies" class="back-link">
      <svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true">
        <path d="M10 12L6 8l4-4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      <span>All Case Studies</span>
    </a>

    <div class="hero-content">
      <p class="client-label">{client}</p>
      <h1 class="hero-title">{title}</h1>
      <p class="hero-summary">{summary}</p>

      {services.length > 0 && (
        <ul class="hero-services">
          {services.map(service => (
            <li class="service-tag">{service}</li>
          ))}
        </ul>
      )}
    </div>

    {impact && (
      <div class="impact-card" style={`border-left-color: ${colorScheme.primary};`}>
        <span class="impact-label">Key Impact</span>
        <p class="impact-text">{impact}</p>
      </div>
    )}
  </div>

  <!-- Bottom accent -->
  <div
    class="bottom-accent"
    style={`background: linear-gradient(90deg, ${colorScheme.primary}, ${colorScheme.secondary});`}
    aria-hidden="true"
  ></div>
</header>

<script>
  // Subtle parallax on scroll
  const watermark = document.querySelector('.watermark-logo') as SVGElement;
  if (watermark && !window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
    window.addEventListener('scroll', () => {
      const scrollY = window.scrollY;
      const parallax = scrollY * 0.15;
      watermark.style.transform = `translateY(${parallax}px) rotate(${scrollY * 0.01}deg)`;
    }, { passive: true });
  }
</script>

<style>
  .case-study-hero {
    position: relative;
    background: var(--color-white);
    padding: 140px 5% 80px;
    min-height: 60vh;
    overflow: hidden;
  }

  .watermark-container {
    position: absolute;
    top: -10%;
    right: -5%;
    width: 55%;
    max-width: 600px;
    height: auto;
    pointer-events: none;
    z-index: 0;
  }

  .watermark-logo {
    width: 100%;
    height: auto;
    will-change: transform;
  }

  .hero-inner {
    position: relative;
    z-index: 1;
    max-width: 680px;
    margin: 0 auto;
  }

  .back-link {
    display: inline-flex;
    align-items: center;
    gap: 0.375rem;
    color: var(--color-teal-blue);
    font-size: 0.875rem;
    font-weight: 500;
    text-decoration: none;
    margin-bottom: 3rem;
    transition: opacity 0.2s ease;
  }

  .back-link:hover {
    opacity: 0.7;
  }

  .hero-content {
    margin-bottom: 2.5rem;
  }

  .client-label {
    font-family: var(--font-primary);
    font-size: var(--text-caption);
    font-weight: var(--font-weight-semibold);
    letter-spacing: 0.05em;
    text-transform: uppercase;
    margin-bottom: 1rem;
    color: var(--color-teal-blue);
  }

  .hero-title {
    color: var(--color-forest-green);
    font-family: var(--font-primary);
    font-size: var(--text-display);
    font-weight: var(--font-weight-bold);
    line-height: 1.1;
    letter-spacing: -0.02em;
    margin-bottom: 1.5rem;
    text-wrap: balance;
  }

  .hero-summary {
    color: var(--color-forest-green);
    font-family: var(--font-primary);
    font-size: var(--text-intro);
    font-weight: var(--font-weight-medium);
    line-height: 1.6;
    opacity: 0.75;
    max-width: 580px;
  }

  .hero-services {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    list-style: none;
    padding: 0;
    margin: 2rem 0 0 0;
  }

  .service-tag {
    font-family: var(--font-primary);
    font-size: var(--text-caption);
    font-weight: var(--font-weight-medium);
    color: var(--color-teal-blue);
    background: rgba(65, 129, 142, 0.08);
    padding: 0.25rem 0.75rem;
    border-radius: 2px;
  }

  .impact-card {
    background: var(--color-rice-white);
    border-left: 4px solid;
    border-radius: 0 12px 12px 0;
    padding: 1.5rem 1.75rem;
    max-width: 520px;
  }

  .impact-label {
    display: block;
    font-family: var(--font-primary);
    font-size: var(--text-caption);
    font-weight: var(--font-weight-semibold);
    letter-spacing: 0.05em;
    text-transform: uppercase;
    color: var(--color-teal-blue);
    margin-bottom: 0.75rem;
  }

  .impact-text {
    font-family: var(--font-primary);
    font-size: var(--text-body);
    font-weight: var(--font-weight-regular);
    font-style: italic;
    line-height: 1.6;
    color: var(--color-forest-green);
    margin: 0;
  }

  .bottom-accent {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: 4px;
  }

  @media (max-width: 768px) {
    .case-study-hero {
      padding: 120px 6% 60px;
    }

    .watermark-container {
      width: 70%;
      top: 0;
      right: -15%;
    }

    .hero-summary {
      font-size: 1rem;
    }

    .impact-card {
      padding: 1.25rem 1.5rem;
    }

    .impact-text {
      font-size: 1rem;
    }
  }
</style>
